{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../_services/job-offer.service\";\nimport * as i2 from \"../../_services/auth.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"ngx-toastr\";\nimport * as i5 from \"@angular/common\";\nfunction JobOffersComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function JobOffersComponent_div_5_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.createOffer());\n    });\n    i0.ɵɵelement(2, \"i\", 10);\n    i0.ɵɵtext(3, \" Cr\\u00E9er une offre \");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction JobOffersComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11);\n    i0.ɵɵtext(1, \" Chargement des offres... \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction JobOffersComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.error, \" \");\n  }\n}\nfunction JobOffersComponent_div_9_button_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function JobOffersComponent_div_9_button_21_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const offer_r6 = i0.ɵɵnextContext().$implicit;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.applyToOffer(offer_r6.id));\n    });\n    i0.ɵɵelement(1, \"i\", 28);\n    i0.ɵɵtext(2, \" Postuler \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction JobOffersComponent_div_9_button_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function JobOffersComponent_div_9_button_22_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const offer_r6 = i0.ɵɵnextContext().$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.deleteOffer(offer_r6.id));\n    });\n    i0.ɵɵelement(1, \"i\", 30);\n    i0.ɵɵtext(2, \" Supprimer \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction JobOffersComponent_div_9_div_23_tr_16_button_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 37);\n    i0.ɵɵlistener(\"click\", function JobOffersComponent_div_9_div_23_tr_16_button_10_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r22);\n      const application_r17 = i0.ɵɵnextContext().$implicit;\n      const ctx_r20 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r20.handleApplication(application_r17.id, \"Accepted\"));\n    });\n    i0.ɵɵelement(1, \"i\", 38);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction JobOffersComponent_div_9_div_23_tr_16_button_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r25 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function JobOffersComponent_div_9_div_23_tr_16_button_11_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r25);\n      const application_r17 = i0.ɵɵnextContext().$implicit;\n      const ctx_r23 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r23.handleApplication(application_r17.id, \"Rejected\"));\n    });\n    i0.ɵɵelement(1, \"i\", 40);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction JobOffersComponent_div_9_div_23_tr_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\")(7, \"span\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtemplate(10, JobOffersComponent_div_9_div_23_tr_16_button_10_Template, 2, 0, \"button\", 35);\n    i0.ɵɵtemplate(11, JobOffersComponent_div_9_div_23_tr_16_button_11_Template, 2, 0, \"button\", 36);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const application_r17 = ctx.$implicit;\n    const ctx_r16 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(application_r17.userId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(5, 7, application_r17.applicationDate));\n    i0.ɵɵadvance(3);\n    i0.ɵɵclassMap(ctx_r16.getStatusBadgeClass(application_r17.status));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(application_r17.status);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", application_r17.status === \"Pending\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", application_r17.status === \"Pending\");\n  }\n}\nfunction JobOffersComponent_div_9_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31)(1, \"h6\");\n    i0.ɵɵtext(2, \"Candidatures :\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 32)(4, \"table\", 33)(5, \"thead\")(6, \"tr\")(7, \"th\");\n    i0.ɵɵtext(8, \"ID Candidat\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10, \"Date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Statut\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"Actions\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(15, \"tbody\");\n    i0.ɵɵtemplate(16, JobOffersComponent_div_9_div_23_tr_16_Template, 12, 9, \"tr\", 34);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const offer_r6 = i0.ɵɵnextContext().$implicit;\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(16);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r9.getApplicationsForOffer(offer_r6.id));\n  }\n}\nfunction JobOffersComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 14)(2, \"div\", 15)(3, \"div\", 16)(4, \"h5\", 17);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"span\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"p\", 18);\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"div\", 19)(11, \"p\");\n    i0.ɵɵelement(12, \"i\", 20);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\");\n    i0.ɵɵelement(15, \"i\", 21);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"p\");\n    i0.ɵɵelement(18, \"i\", 22);\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(20, \"div\", 23);\n    i0.ɵɵtemplate(21, JobOffersComponent_div_9_button_21_Template, 3, 0, \"button\", 24);\n    i0.ɵɵtemplate(22, JobOffersComponent_div_9_button_22_Template, 3, 0, \"button\", 25);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(23, JobOffersComponent_div_9_div_23_Template, 17, 1, \"div\", 26);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const offer_r6 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(offer_r6.title);\n    i0.ɵɵadvance(1);\n    i0.ɵɵclassMap(ctx_r3.getStatusBadgeClass(offer_r6.status));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(offer_r6.status);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(offer_r6.description);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", offer_r6.location, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", offer_r6.degree, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", offer_r6.salary, \" DH\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.canApply());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.canManageOffers());\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.canManageApplications() && ctx_r3.getApplicationsForOffer(offer_r6.id).length > 0);\n  }\n}\nexport let JobOffersComponent = /*#__PURE__*/(() => {\n  class JobOffersComponent {\n    constructor(jobOfferService, authService, router, toastr) {\n      this.jobOfferService = jobOfferService;\n      this.authService = authService;\n      this.router = router;\n      this.toastr = toastr;\n      this.offers = [];\n      this.applications = {};\n      this.loading = false;\n      this.error = '';\n      this.userType = null;\n      const currentUser = this.authService.currentUserValue;\n      this.userType = currentUser?.userType || null;\n    }\n    ngOnInit() {\n      this.loadOffers();\n    }\n    loadOffers() {\n      this.loading = true;\n      this.jobOfferService.getAllOffers().subscribe({\n        next: data => {\n          this.offers = data;\n          if (this.canManageApplications()) {\n            this.loadApplicationsForOffers();\n          }\n          this.loading = false;\n        },\n        error: error => {\n          this.error = error.error?.message || 'Erreur lors du chargement des offres';\n          this.loading = false;\n          this.toastr.error(this.error);\n        }\n      });\n    }\n    loadApplicationsForOffers() {\n      this.offers.forEach(offer => {\n        this.jobOfferService.getApplicationsForOffer(offer.id).subscribe({\n          next: applications => {\n            this.applications[offer.id] = applications;\n          },\n          error: error => {\n            this.toastr.error(`Erreur lors du chargement des candidatures pour l'offre ${offer.title}`);\n          }\n        });\n      });\n    }\n    canManageApplications() {\n      return this.userType === 'company' || this.userType === 'admin';\n    }\n    applyToOffer(offerId) {\n      this.jobOfferService.applyToOffer(offerId).subscribe({\n        next: () => {\n          this.toastr.success('Candidature envoyée avec succès');\n          this.loadOffers(); // Recharger les offres après candidature\n        },\n\n        error: error => {\n          this.toastr.error(error.error?.message || 'Erreur lors de la candidature');\n        }\n      });\n    }\n    viewOfferDetails(offerId) {\n      this.router.navigate(['/job-offers', offerId]);\n    }\n    static #_ = this.ɵfac = function JobOffersComponent_Factory(t) {\n      return new (t || JobOffersComponent)(i0.ɵɵdirectiveInject(i1.JobOfferService), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.ToastrService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: JobOffersComponent,\n      selectors: [[\"app-job-offers\"]],\n      decls: 10,\n      vars: 4,\n      consts: [[1, \"container\", \"mt-4\"], [1, \"row\", \"mb-4\"], [1, \"col\"], [\"class\", \"col-auto\", 4, \"ngIf\"], [\"class\", \"alert alert-info\", 4, \"ngIf\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [1, \"row\"], [\"class\", \"col-md-12\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-auto\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"fas\", \"fa-plus\"], [1, \"alert\", \"alert-info\"], [1, \"alert\", \"alert-danger\"], [1, \"col-md-12\"], [1, \"card\", \"mb-3\"], [1, \"card-body\"], [1, \"d-flex\", \"justify-content-between\", \"align-items-start\"], [1, \"card-title\"], [1, \"card-text\"], [1, \"job-details\"], [1, \"fas\", \"fa-map-marker-alt\"], [1, \"fas\", \"fa-graduation-cap\"], [1, \"fas\", \"fa-money-bill-wave\"], [1, \"mt-3\"], [\"class\", \"btn btn-success me-2\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"btn btn-danger me-2\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"mt-4\", 4, \"ngIf\"], [1, \"btn\", \"btn-success\", \"me-2\", 3, \"click\"], [1, \"fas\", \"fa-paper-plane\"], [1, \"btn\", \"btn-danger\", \"me-2\", 3, \"click\"], [1, \"fas\", \"fa-trash\"], [1, \"mt-4\"], [1, \"table-responsive\"], [1, \"table\", \"table-sm\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"btn btn-success btn-sm me-1\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"btn btn-danger btn-sm\", 3, \"click\", 4, \"ngIf\"], [1, \"btn\", \"btn-success\", \"btn-sm\", \"me-1\", 3, \"click\"], [1, \"fas\", \"fa-check\"], [1, \"btn\", \"btn-danger\", \"btn-sm\", 3, \"click\"], [1, \"fas\", \"fa-times\"]],\n      template: function JobOffersComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h2\");\n          i0.ɵɵtext(4, \"Offres d'emploi\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(5, JobOffersComponent_div_5_Template, 4, 0, \"div\", 3);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(6, JobOffersComponent_div_6_Template, 2, 0, \"div\", 4);\n          i0.ɵɵtemplate(7, JobOffersComponent_div_7_Template, 2, 1, \"div\", 5);\n          i0.ɵɵelementStart(8, \"div\", 6);\n          i0.ɵɵtemplate(9, JobOffersComponent_div_9_Template, 24, 11, \"div\", 7);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.canManageOffers());\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.loading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.offers);\n        }\n      },\n      dependencies: [i5.NgForOf, i5.NgIf, i5.DatePipe]\n    });\n  }\n  return JobOffersComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}